# AGENTS.md â€” PokerHub

> Auto-generated by SMH init on 2026-02-17. AI agent reference for codebase navigation.

## Architecture

**Type**: Full-stack web application
**Framework**: Next.js 16.1.6 (App Router) + TypeScript
**Database**: PostgreSQL (Supabase) + Drizzle ORM
**Auth**: Custom JWT (jose + bcryptjs)
**State**: Zustand (client), Server Actions (server)
**Styling**: Tailwind CSS v4 + Radix UI + shadcn/ui

## Domains

| Domain | Schema Tables | Key Files |
|--------|--------------|-----------|
| User | users, userFollows, userBlocks, userSettings | `src/lib/auth/`, `src/app/(auth)/`, `src/app/(user)/` |
| Content | boards, posts, comments, postLikes, commentLikes, bookmarks, tags, postTags, strategyVotes, reports | `src/app/(boards)/`, `src/lib/queries/boards.ts` |
| Poker (Shared Hands) | pokerHands, pokerHandPlayers, pokerHandActions, pokerHandComments | `src/app/(poker)/`, `src/components/poker/` |
| Poker (Live Tables) | pokerTables, pokerTableSeats, pokerGameHands, pokerGameActions, pokerGameResults | `src/lib/poker/`, `src/app/poker/`, `src/app/api/poker/` |
| Gamification | badges, userBadges, missions, userMissions, attendance, userStreaks, pointTransactions, xpTransactions, levelConfigs | `src/lib/gamification/`, `src/app/(gamification)/` |
| Social | notifications, chatRooms, chatMessages, threads, threadLikes, threadReplies | `src/app/(social)/`, `src/components/social/` |
| Games | cooldownRewards, lotteryTickets, rouletteSpins | `src/app/(games)/` |
| Admin | banners, adminLogs | `src/app/(admin)/` |

## API Routes

| Endpoint | Method | Purpose |
|----------|--------|---------|
| `/api/auth/login` | POST | User login |
| `/api/auth/logout` | POST | User logout |
| `/api/auth/register` | POST | User registration |
| `/api/news` | GET | RSS news aggregation |
| `/api/poker/[tableId]` | GET (SSE) | Live poker table events |
| `/api/upload` | POST | File upload |

## Pages (30 routes)

### Auth: `/login`, `/register`
### Home: `/` (HomeClient.tsx)
### Boards: `/board/[slug]`, `/board/[slug]/[postId]`, `/board/[slug]/write`, `/news`
### Poker: `/hands`, `/hands/[handId]`, `/hands/share`, `/poker` (lobby), `/poker/[tableId]` (live table)
### Gamification: `/attendance`, `/missions`, `/rankings`
### Social: `/threads`, `/threads/[threadId]`, `/chat`, `/chat/[roomId]`
### Games: `/lottery`, `/roulette`
### User: `/profile/[userId]`, `/profile/[userId]/followers`, `/profile/[userId]/following`, `/settings`, `/points`
### Other: `/notifications`, `/search`, `/admin`, `/design-system`

## Poker Engine

The poker engine at `src/lib/poker/` handles:
- **engine.ts**: Core PokerEngine class (start hand, validate/apply actions, advance street, resolve showdown)
- **evaluator.ts**: Hand evaluation (ranking poker hands)
- **gameLoop.ts**: Orchestrates DB + engine for live tables
- **store.ts**: Zustand store for client-side poker state
- **usePokerTable.ts**: React hook for poker table interactions
- **deck.ts**: Card deck management
- **types.ts**: Poker type definitions

## Key Patterns

- **Server Actions**: Located in `actions.ts` within route groups
- **Bilingual fields**: `nameKo`/`nameEn` pattern in DB schema
- **Session**: JWT-based via `src/lib/auth/session.ts`, middleware at `src/middleware.ts`
- **Supabase clients**: `client.ts` (browser), `server.ts` (RSC), `admin.ts` (service role)
- **Real-time**: SSE polling (1s interval) for poker tables, not WebSockets

## No Tests

No test framework configured. No test files exist.
